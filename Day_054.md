# Day 54: Kubernetes Shared Volumes
We are working on an application that will be deployed on multiple containers within a pod on Kubernetes cluster. There is a requirement to share a volume among the containers to save some temporary data. The Nautilus DevOps team is developing a similar template to replicate the scenario. Below you can find more details about it.

* Create a pod named `volume-share-nautilus`.

* For the first container, use image `fedora` with latest tag only and remember to mention the tag i.e `fedora:latest`, container should be named as `volume-container-nautilus-1`, and run a sleep command for it so that it remains in running state. Volume `volume-share` should be mounted at path `/tmp/blog`.

* For the second container, use image `fedora` with the latest tag only and remember to mention the tag i.e `fedora:latest`, container should be named as `volume-container-nautilus-2`, and again run a sleep command for it so that it remains in running state. Volume `volume-share` should be mounted at path `/tmp/games`.

* Volume name should be `volume-share` of type `emptyDir`.

* After creating the pod, exec into the first container i.e `volume-container-nautilus-1`, and just for testing create a file `blog.txt` with any content under the mounted path of first container i.e `/tmp/blog`.

* The file `blog.txt` should be present under the mounted path `/tmp/games` on the second container `volume-container-nautilus-2` as well, since they are using a shared volume.

> Note: The kubectl utility on jump_host has been configured to work with the kubernetes cluster.


## Solution
On the jump host, create a pod.yaml file
```sh
kubectl run volume-share-nautilus --image fedora:latest --dry-run=client -o yaml > pod.yaml
```


Modify the pod.yaml file in the containers secton like below
```
  containers:
  - image: fedora:latest
    name: volume-container-nautilus-1
    resources: {}
    command: ['sh', '-c', 'echo "Hello, Kubernetes!" && sleep 3600']
    volumeMounts:
    - name: volume-share
      mountPath: /tmp/blog
  - image: fedora:latest
    name: volume-container-nautilus-2
    resources: {}
    command: ['sh', '-c', 'echo "Hello, Kubernetes!" && sleep 3600']
    volumeMounts:
    - name: volume-share
      mountPath: /tmp/games
  volumes:
  - name: volume-share
    emptyDir: {}
```

Create the pod using updated pod.yaml
```sh
kubectl create -f pod.yaml
```


Exec into the first container and create a file `blog.txt` inside `/bin/bash` shell
```sh
kubectl exec volume-share-nautilus -it -c volume-container-nautilus-1 -- /bin/bash
   # touch /tmp/blog/blog.txt
   # echo "Hello kodekloud" > /tmp/blog/blog.txt
```


Verify the second container has `blog.txt` file under `/tmp/games` path
```sh
kubectl exec volume-share-nautilus -it -c volume-container-nautilus-2 -- cat /tmp/games/blog.txt
"Hello kodekloud"
```
